{"ast":null,"code":"var _jsxFileName = \"/home/raju/Documents/Channakya/customer/client/src/components/Content/Contract/ReactForm.tsx\",\n    _s = $RefreshSig$();\n\nimport { Button, Dialog, DialogActions, DialogContent, DialogTitle, FormHelperText, MenuItem, TextField } from \"@material-ui/core\";\nimport { Controller, useForm } from \"react-hook-form\";\nimport moment from \"moment\";\nimport { useEffect } from \"react\";\nimport axios from \"axios\";\nimport { useSWRConfig } from \"swr\";\nimport { useSnackbar } from \"notistack\"; // dev tool for hook form\n\nimport { DevTool } from \"@hookform/devtools\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nlet renderCount = 0;\n\nconst ReactForm = ({\n  openDialog,\n  setOpenDialog,\n  isEditMode,\n  setIsEditMode,\n  clients,\n  toEditData,\n  setToEditData,\n  updateId\n}) => {\n  _s();\n\n  const {\n    enqueueSnackbar\n  } = useSnackbar(); // swr config\n\n  const {\n    mutate\n  } = useSWRConfig();\n  const CONTRACT_API = \"api/contract/\"; // date today and one year after\n\n  const signDate = moment().format(\"yyyy-MM-DD\").toString();\n  const endDate = moment().add(1, \"y\").format(\"yyyy-MM-DD\").toString(); // hook form default date values\n\n  const defaultValues = {\n    contract_sign_date: signDate,\n    contract_end_date: endDate,\n    client_id: (toEditData === null || toEditData === void 0 ? void 0 : toEditData.client_id._id) || undefined,\n    payment_status: (toEditData === null || toEditData === void 0 ? void 0 : toEditData.payment_status) || undefined\n  }; // hook form\n\n  const {\n    register,\n    handleSubmit,\n    reset,\n    control,\n    formState: {\n      errors\n    }\n  } = useForm({\n    defaultValues: defaultValues\n  });\n  useEffect(() => {\n    if (isEditMode) reset({ ...defaultValues\n    });\n  }, [isEditMode]);\n\n  const handleClose = () => {\n    setIsEditMode(false);\n    setOpenDialog(false);\n    setToEditData(null);\n    reset();\n  };\n\n  const onSubmit = data => {\n    console.log(\"ob submit\");\n    console.log(data);\n    if (!isEditMode) axios.post(CONTRACT_API, data).then(({\n      data\n    }) => {\n      mutate(CONTRACT_API);\n      setOpenDialog(false);\n      reset();\n      enqueueSnackbar(data.success_msg, {\n        variant: \"success\"\n      });\n    }).catch(err => {\n      console.log(err);\n    });else {\n      console.log(data);\n      axios.patch(CONTRACT_API + updateId, data).then(({\n        data\n      }) => {\n        mutate(CONTRACT_API);\n        setOpenDialog(false);\n        setIsEditMode(false);\n        reset();\n        enqueueSnackbar(data.success_msg, {\n          variant: \"success\"\n        });\n      }).catch(err => {\n        console.log(err);\n      });\n    }\n  };\n\n  console.log(\"edit data\");\n  console.log(toEditData);\n  console.log(isEditMode);\n  console.log(\"default values\");\n  console.log(defaultValues);\n  console.log(renderCount);\n  return /*#__PURE__*/_jsxDEV(Dialog, {\n    open: openDialog,\n    onClose: handleClose,\n    \"aria-labelledby\": \"form-dialog-title\",\n    children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n      id: \"form-dialog-title\",\n      children: isEditMode ? \"Update Contract\" : \"Add Contract\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit(onSubmit),\n      children: [/*#__PURE__*/_jsxDEV(DialogContent, {\n        children: [/*#__PURE__*/_jsxDEV(Controller, {\n          name: \"client_id\",\n          control: control,\n          rules: {\n            required: \"Client is required!\"\n          } // defaultValue={defaultValues?.client_id}\n          ,\n          render: ({\n            field\n          }) => /*#__PURE__*/_jsxDEV(TextField, {\n            select: true,\n            ...field,\n            style: {\n              marginBottom: \"10px\"\n            },\n            label: \"Client\",\n            fullWidth: true,\n            variant: \"outlined\",\n            error: !!errors.client_id,\n            children: clients && clients.map(client => /*#__PURE__*/_jsxDEV(MenuItem, {\n              value: client._id,\n              children: client.company_name\n            }, client._id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 141,\n              columnNumber: 21\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(FormHelperText, {\n          className: \"MuiFormHelperText-root MuiFormHelperText-contained Mui-error\",\n          children: errors && errors.client_id && errors.client_id.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Controller, {\n          name: \"payment_status\",\n          rules: {\n            required: \"Payment Status is required!\"\n          },\n          control: control // defaultValue={defaultValues.payment_status}\n          ,\n          render: ({\n            field\n          }) => /*#__PURE__*/_jsxDEV(TextField, { ...field,\n            select: true,\n            label: \"Payment Status\",\n            fullWidth: true,\n            variant: \"outlined\",\n            error: !!errors.payment_status,\n            children: [/*#__PURE__*/_jsxDEV(MenuItem, {\n              value: \"paid\",\n              children: \"Paid\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 166,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(MenuItem, {\n              value: \"notpaid\",\n              children: \"Not Paid\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 167,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 158,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(FormHelperText, {\n          className: \"MuiFormHelperText-root MuiFormHelperText-contained Mui-error\",\n          children: errors && errors.payment_status && errors.payment_status.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(TextField, { ...register(\"contract_sign_date\", {\n            required: \"Contract Sign Date is required!\"\n          }),\n          fullWidth: true,\n          margin: \"normal\",\n          variant: \"outlined\",\n          label: \"Contract Sign Date\",\n          type: \"date\",\n          error: !!errors.contract_sign_date,\n          helperText: errors && errors.contract_sign_date && errors.contract_sign_date.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(TextField, { ...register(\"contract_end_date\", {\n            required: \"Contract End Date is required!\"\n          }),\n          fullWidth: true,\n          margin: \"normal\",\n          variant: \"outlined\",\n          label: \"Contract End Date\",\n          type: \"date\",\n          error: !!errors.contract_end_date,\n          helperText: errors && errors.contract_end_date && errors.contract_end_date.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => {},\n          color: \"primary\",\n          variant: \"contained\",\n          type: \"submit\",\n          children: isEditMode ? \"Update\" : \"Save\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: handleClose // onClick={() => {\n          //   setOpenDialog(false);\n          //   reset({});\n          // }}\n          ,\n          color: \"secondary\",\n          variant: \"contained\",\n          children: \"Close\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(DevTool, {\n      control: control\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 7\n    }, this), \" \"]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 114,\n    columnNumber: 5\n  }, this);\n};\n\n_s(ReactForm, \"Xz4JkdgoVZltUqyVmWJtJ3t2x8w=\", false, function () {\n  return [useSnackbar, useSWRConfig, useForm];\n});\n\n_c = ReactForm;\nexport default ReactForm;\n\nvar _c;\n\n$RefreshReg$(_c, \"ReactForm\");","map":{"version":3,"sources":["/home/raju/Documents/Channakya/customer/client/src/components/Content/Contract/ReactForm.tsx"],"names":["Button","Dialog","DialogActions","DialogContent","DialogTitle","FormHelperText","MenuItem","TextField","Controller","useForm","moment","useEffect","axios","useSWRConfig","useSnackbar","DevTool","renderCount","ReactForm","openDialog","setOpenDialog","isEditMode","setIsEditMode","clients","toEditData","setToEditData","updateId","enqueueSnackbar","mutate","CONTRACT_API","signDate","format","toString","endDate","add","defaultValues","contract_sign_date","contract_end_date","client_id","_id","undefined","payment_status","register","handleSubmit","reset","control","formState","errors","handleClose","onSubmit","data","console","log","post","then","success_msg","variant","catch","err","patch","required","field","marginBottom","map","client","company_name","message"],"mappings":"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","sourcesContent":["import {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  FormHelperText,\n  MenuItem,\n  TextField,\n} from \"@material-ui/core\";\n\nimport { Controller, useForm } from \"react-hook-form\";\nimport moment from \"moment\";\nimport { ContractType } from \"./types\";\nimport { useEffect } from \"react\";\nimport axios from \"axios\";\nimport { useSWRConfig } from \"swr\";\nimport { useSnackbar } from \"notistack\";\n// dev tool for hook form\nimport { DevTool } from \"@hookform/devtools\";\n\nlet renderCount = 0;\n\nconst ReactForm = ({\n  openDialog,\n  setOpenDialog,\n  isEditMode,\n  setIsEditMode,\n  clients,\n  toEditData,\n  setToEditData,\n  updateId,\n}) => {\n  const { enqueueSnackbar } = useSnackbar();\n\n  // swr config\n  const { mutate } = useSWRConfig();\n  const CONTRACT_API = \"api/contract/\";\n\n  // date today and one year after\n  const signDate: string = moment().format(\"yyyy-MM-DD\").toString();\n  const endDate: string = moment().add(1, \"y\").format(\"yyyy-MM-DD\").toString();\n\n  // hook form default date values\n  const defaultValues = {\n    contract_sign_date: signDate,\n    contract_end_date: endDate,\n    client_id: toEditData?.client_id._id || undefined,\n    payment_status: toEditData?.payment_status || undefined,\n  };\n\n  // hook form\n  const {\n    register,\n    handleSubmit,\n    reset,\n    control,\n    formState: { errors },\n  } = useForm<ContractType>({\n    defaultValues: defaultValues,\n  });\n\n  useEffect(() => {\n    if (isEditMode) reset({ ...defaultValues });\n  }, [isEditMode]);\n\n  const handleClose = () => {\n    setIsEditMode(false);\n    setOpenDialog(false);\n    setToEditData(null);\n    reset();\n  };\n\n  const onSubmit = (data: ContractType) => {\n    console.log(\"ob submit\");\n    console.log(data);\n    if (!isEditMode)\n      axios\n        .post(CONTRACT_API, data)\n        .then(({ data }) => {\n          mutate(CONTRACT_API);\n          setOpenDialog(false);\n          reset();\n          enqueueSnackbar(data.success_msg, { variant: \"success\" });\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    else {\n      console.log(data);\n      axios\n        .patch(CONTRACT_API + updateId, data)\n        .then(({ data }) => {\n          mutate(CONTRACT_API);\n          setOpenDialog(false);\n          setIsEditMode(false);\n          reset();\n          enqueueSnackbar(data.success_msg, { variant: \"success\" });\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    }\n  };\n\n  console.log(\"edit data\");\n  console.log(toEditData);\n  console.log(isEditMode);\n  console.log(\"default values\");\n  console.log(defaultValues);\n  console.log(renderCount);\n\n  return (\n    <Dialog\n      open={openDialog}\n      onClose={handleClose}\n      aria-labelledby=\"form-dialog-title\"\n    >\n      <DialogTitle id=\"form-dialog-title\">\n        {isEditMode ? \"Update Contract\" : \"Add Contract\"}\n      </DialogTitle>\n      <form onSubmit={handleSubmit(onSubmit)}>\n        <DialogContent>\n          <Controller\n            name=\"client_id\"\n            control={control}\n            rules={{ required: \"Client is required!\" }}\n            // defaultValue={defaultValues?.client_id}\n            render={({ field }) => (\n              <TextField\n                select\n                {...field}\n                style={{ marginBottom: \"10px\" }}\n                label=\"Client\"\n                fullWidth\n                variant=\"outlined\"\n                error={!!errors.client_id}\n              >\n                {clients &&\n                  clients.map((client) => (\n                    <MenuItem key={client._id} value={client._id}>\n                      {client.company_name}\n                    </MenuItem>\n                  ))}\n              </TextField>\n            )}\n          />\n          <FormHelperText className=\"MuiFormHelperText-root MuiFormHelperText-contained Mui-error\">\n            {errors && errors.client_id && errors.client_id.message}\n          </FormHelperText>\n\n          <Controller\n            name=\"payment_status\"\n            rules={{ required: \"Payment Status is required!\" }}\n            control={control}\n            // defaultValue={defaultValues.payment_status}\n            render={({ field }) => (\n              <TextField\n                {...field}\n                select\n                label=\"Payment Status\"\n                fullWidth\n                variant=\"outlined\"\n                error={!!errors.payment_status}\n              >\n                <MenuItem value=\"paid\">Paid</MenuItem>\n                <MenuItem value=\"notpaid\">Not Paid</MenuItem>\n              </TextField>\n            )}\n          />\n          <FormHelperText className=\"MuiFormHelperText-root MuiFormHelperText-contained Mui-error\">\n            {errors && errors.payment_status && errors.payment_status.message}\n          </FormHelperText>\n\n          <TextField\n            {...register(\"contract_sign_date\", {\n              required: \"Contract Sign Date is required!\",\n            })}\n            fullWidth\n            margin=\"normal\"\n            variant=\"outlined\"\n            label=\"Contract Sign Date\"\n            type=\"date\"\n            error={!!errors.contract_sign_date}\n            helperText={\n              errors &&\n              errors.contract_sign_date &&\n              errors.contract_sign_date.message\n            }\n          />\n          <TextField\n            {...register(\"contract_end_date\", {\n              required: \"Contract End Date is required!\",\n            })}\n            fullWidth\n            margin=\"normal\"\n            variant=\"outlined\"\n            label=\"Contract End Date\"\n            type=\"date\"\n            error={!!errors.contract_end_date}\n            helperText={\n              errors &&\n              errors.contract_end_date &&\n              errors.contract_end_date.message\n            }\n          />\n        </DialogContent>\n        <DialogActions>\n          <Button\n            onClick={() => {}}\n            color=\"primary\"\n            variant=\"contained\"\n            type=\"submit\"\n          >\n            {isEditMode ? \"Update\" : \"Save\"}\n          </Button>\n          <Button\n            onClick={handleClose}\n            // onClick={() => {\n            //   setOpenDialog(false);\n            //   reset({});\n            // }}\n            color=\"secondary\"\n            variant=\"contained\"\n          >\n            Close\n          </Button>\n        </DialogActions>\n      </form>\n      <DevTool control={control} /> {/* set up the dev tool */}\n    </Dialog>\n  );\n};\n\nexport default ReactForm;\n"]},"metadata":{},"sourceType":"module"}